<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        h1 {
            margin-bottom: 10px;
        }
        #todoList .todo {
            border: 1px solid #ccc;
            padding: 12px;
            margin: 8px 0;
            border-radius: 6px;
        }
        .completed-title {
            color: green;
            text-decoration: line-through;
        }
        button {
            margin-left: 8px;
            cursor: pointer;
        }
        .empty-msg {
            color: red;
            font-weight: bold;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Todo List</h1>
    <button onclick="fetchTodos()">Fetch Todos</button>
    <div id="todoList"></div>
    <script>
        // Fetch & Store 20 Todos
        async function fetchTodos() {
            try {
                const res = await fetch("https://jsonplaceholder.typicode.com/todos");
                const data = await res.json();

                const first20 = data.slice(0, 20);

                localStorage.setItem("todos", JSON.stringify(first20));

                renderTodos();
            } catch (error) {
                console.error("Error fetching data:", error);
            }
        }
        // Get Todos from Local Storage
        function getTodos() {
            return JSON.parse(localStorage.getItem("todos")) || [];
        }
        // Save Todos back into Local Storage
        function saveTodos(todos) {
            localStorage.setItem("todos", JSON.stringify(todos));
        }
        // Delete a Todo
        function deleteTodo(id) {
            let todos = getTodos();
            todos = todos.filter(todo => todo.id !== id);
            saveTodos(todos);
            renderTodos();
        }
        // Toggle Completion Status
        function toggleTodo(id) {
            let todos = getTodos();

            todos = todos.map(todo => {
                if (todo.id === id) {
                    return { ...todo, completed: !todo.completed };
                }
                return todo;
            });
            saveTodos(todos);
            renderTodos();
        }
        // Render Todos to UI
        function renderTodos() {
            const container = document.getElementById("todoList");
            const todos = getTodos();
            container.innerHTML = "";
            // If no todos
            if (todos.length === 0) {
                container.innerHTML = `<p class="empty-msg">No Todos Available</p>`;
                return;
            }
            // Render each todo
            todos.forEach(todo => {
                const div = document.createElement("div");
                div.className = "todo";

                const title = document.createElement("span");
                title.textContent = todo.title + " ";
                if (todo.completed) title.classList.add("completed-title");

                const status = document.createElement("span");
                status.textContent = todo.completed ? "✓ Completed " : "⛔ Not Completed ";

                const toggleBtn = document.createElement("button");
                toggleBtn.textContent = "Toggle";
                toggleBtn.onclick = () => toggleTodo(todo.id);

                const deleteBtn = document.createElement("button");
                deleteBtn.textContent = "Delete";
                deleteBtn.onclick = () => deleteTodo(todo.id);

                div.appendChild(title);
                div.appendChild(status);
                div.appendChild(toggleBtn);
                div.appendChild(deleteBtn);

                container.appendChild(div);
            });
        }
        // On Page Load → Show saved todos
        renderTodos();
    </script>
</body>
</html>
